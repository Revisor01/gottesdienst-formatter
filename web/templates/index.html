{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card mt-4">
            <div class="card-header">
                <h4 class="mb-0">Excel-Datei hochladen</h4>
            </div>
            <div class="card-body">
                <p class="text-muted">
                    Laden Sie Ihre Excel-Datei mit den Gottesdienstdaten hoch. 
                    Das System konvertiert die Daten automatisch in das von Boyens Medien geforderte Format.
                </p>
                
                <form method="POST" action="{{ url_for('upload_file') }}" enctype="multipart/form-data">
                    <div class="file-upload-area">
                        <div class="mb-3">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-success">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14,2 14,8 20,8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10,9 9,9 8,9"></polyline>
                            </svg>
                        </div>
                        <h5>Excel-Datei auswählen</h5>
                        <p class="text-muted">Nur .xlsx Dateien werden unterstützt</p>
                        <input type="file" name="file" accept=".xlsx" class="form-control" required>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-lg w-100">
                        Datei verarbeiten
                    </button>
                </form>
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">Anforderungen</h5>
            </div>
            <div class="card-body">
                <p>Die Excel-Datei muss folgende Spalten enthalten:</p>
                <ul class="list-unstyled">
                    <li><strong>Startdatum:</strong> Datum und Uhrzeit des Gottesdienstes</li>
                    <li><strong>Titel:</strong> Art des Gottesdienstes</li>
                    <li><strong>Standortnamen:</strong> Kirche/Ort</li>
                    <li><strong>Mitwirkender:</strong> Pastor/Pastorin</li>
                    <li><strong>Gemeinden:</strong> Gemeinde (falls Standort leer)</li>
                </ul>
                
                <h6 class="mt-3">Ausgabeformat:</h6>
                <div class="bg-light p-3 rounded">
                    <code>
                        Sonntag, 1. Juni:<br>
                        Albersdorf: 9.30 Uhr, Gd., P. Keppel<br>
                        Büsum: 10 Uhr, Gd. m. A., Pn. Schmidt
                    </code>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}